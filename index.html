<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>Lords Mobile Helper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }

        body {
            background: #0a0f1e;
            color: #e4e9f2;
            line-height: 1.5;
            padding: 20px;
            min-height: 100vh;
            background-image: radial-gradient(circle at 10% 20%, rgba(25, 35, 60, 0.4) 0%, transparent 30%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 50px;
            padding-bottom: 15px;
            border-bottom: 1px solid #2a3142;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            font-size: 40px;
        }

        .logo-text {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #ffd700, #c0a060);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .version {
            color: #7e8a9f;
            background: #1a2030;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 14px;
            border: 1px solid #3e4a5d;
        }

        .back-btn {
            background: #1e2435;
            color: #b9c6db;
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            border: 1px solid #3a4357;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: 0.2s;
        }

        .back-btn:hover {
            background: #2a3145;
            color: white;
            border-color: #ffd700;
        }

        .welcome {
            text-align: center;
            margin-bottom: 50px;
        }

        .welcome h1 {
            font-size: 42px;
            font-weight: 700;
            color: #ffd966;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 217, 102, 0.3);
        }

        .welcome p {
            font-size: 20px;
            color: #b6c2d6;
            max-width: 700px;
            margin: 0 auto;
        }

        .sections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .section-card {
            background: #151c2b;
            border-radius: 24px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, #ffd700, #ffb347);
            opacity: 0;
            transition: 0.3s;
        }

        .section-card:hover {
            border-color: #ffd966;
            background: #1e263b;
            transform: translateY(-8px);
            box-shadow: 0 20px 30px rgba(255, 217, 102, 0.15);
        }

        .section-card:hover::before {
            opacity: 1;
        }

        .section-icon {
            font-size: 64px;
            background: #0f141f;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 3px solid #3f4a5e;
            transition: 0.3s;
        }

        .section-card:hover .section-icon {
            border-color: #ffd966;
            transform: scale(1.05);
        }

        .section-title {
            font-size: 26px;
            font-weight: 700;
            color: #f0f3fa;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .section-title-hunt h1 {
            font-size: 36px;
            color: #ffd966;
            margin-bottom: 30px;
        }

        /* –°–¢–ò–õ–ò –î–õ–Ø –ó–ê–ú–ö–û–í ‚Äî –û–î–ù–ê –ö–ù–û–ü–ö–ê –ù–ê –í–°–Æ –®–ò–†–ò–ù–£ */
        .castle-main-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 40px;
        }

        .castle-main-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .castle-main-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .castle-main-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .castle-main-name {
            font-size: 26px;
            font-weight: 700;
            color: #f0f3fa;
            padding: 15px 0;
        }

        /* –°–ï–¢–ö–ê –î–õ–Ø –ù–ê–ó–í–ê–ù–ò–ô ‚Äî 2 –ö–û–õ–û–ù–ö–ò */
        .castle-images-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .castle-image-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .castle-image-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .castle-image-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .castle-image-name {
            font-size: 20px;
            font-weight: 600;
            color: #f0f3fa;
            padding: 10px 0;
        }

        /* –ü–û–õ–ù–û–®–ò–†–ò–ù–ù–ê–Ø –ö–ù–û–ü–ö–ê */
        .castle-image-card-full {
            grid-column: 1 / -1;
            background: #151c2b;
            border-radius: 16px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
            margin-bottom: 20px;
        }

        .castle-image-card-full:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .castle-image-card-full.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .monster-image-container {
            background: #101624;
            border-radius: 24px;
            padding: 30px;
            margin-top: 20px;
            border: 1px solid #2f3a4e;
            text-align: center;
        }

        .monster-image-container h2 {
            font-size: 32px;
            color: #ffd966;
            margin-bottom: 20px;
        }

        .monster-image {
            width: 100%;
            height: auto;
            border-radius: 16px;
            border: 2px solid #4a5568;
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
            display: block;
        }

        .monsters-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .research-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .mana-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .mana-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .mana-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .mana-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .mana-name {
            font-size: 22px;
            font-weight: 700;
            color: #f0f3fa;
            padding: 10px 0;
        }

        .research-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .research-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .research-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .research-name {
            font-size: 22px;
            font-weight: 700;
            color: #f0f3fa;
            padding: 10px 0;
        }

        .calendar-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .calendar-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .calendar-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .calendar-name {
            font-size: 22px;
            font-weight: 700;
            color: #f0f3fa;
            padding: 10px 0;
        }

        .monster-card {
            background: #151c2b;
            border-radius: 16px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.25s;
            width: 100%;
        }

        .monster-card:hover {
            border-color: #ffd966;
            background: #1f273a;
            transform: translateY(-5px);
        }

        .monster-card.active {
            border-color: #ffd700;
            background: #1e263b;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .monster-name {
            font-size: 22px;
            font-weight: 700;
            color: #f0f3fa;
            padding: 10px 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            animation: fadeIn 0.5s ease forwards;
        }

        /* –°–¢–ò–õ–ò –î–õ–Ø –§–£–¢–ï–†–ê */
        .footer {
            margin-top: 60px;
            padding-top: 25px;
            border-top: 1px solid #2a3142;
            color: #7e8a9f;
            font-size: 15px;
        }

        .footer-sources {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .footer-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: #b1bed6;
            text-decoration: none;
            transition: 0.2s;
        }

        .footer-link:hover {
            color: #ffd966;
            text-decoration: underline;
        }

        /* –ê–î–ê–ü–¢–ê–¶–ò–Ø –ü–û–î –ú–û–ë–ò–õ–¨–ù–´–ï –£–°–¢–†–û–ô–°–¢–í–ê */
        @media (max-width: 900px) {
            .monsters-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .mana-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .calendar-grid {
                grid-template-columns: 1fr;
            }
            .research-grid {
                grid-template-columns: 1fr;
            }
            .castle-images-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .monster-card[style*="1 / -1"] {
                grid-column: 1 / -1 !important;
            }
        }

        @media (max-width: 700px) {
            .footer-links {
                flex-direction: column;
                gap: 10px;
            }
        }

        @media (max-width: 600px) {
            .monsters-grid {
                grid-template-columns: 1fr;
            }
            .mana-grid {
                grid-template-columns: 1fr;
            }
            .calendar-grid {
                grid-template-columns: 1fr;
            }
            .research-grid {
                grid-template-columns: 1fr;
            }
            .castle-images-grid {
                grid-template-columns: 1fr;
            }
            
            /* ‚úÖ –ö–ê–†–¢–ò–ù–ö–ò –ù–ê –í–ï–°–¨ –≠–ö–†–ê–ù */
            .monster-image {
                width: 100%;
                height: auto;
                max-width: 100%;
            }
            
            .monster-image-container {
                padding: 15px;
            }
            
            .monster-image-container h2 {
                font-size: 26px;
                margin-bottom: 15px;
            }
            
            /* ‚úÖ –ö–†–£–ü–ù–´–ï –ö–ù–û–ü–ö–ò –î–õ–Ø –ü–ê–õ–¨–¶–ï–í */
            .castle-image-card,
            .castle-image-card-full,
            .monster-card,
            .mana-card,
            .research-card,
            .calendar-card,
            .castle-main-card {
                padding: 20px 12px;
            }
            
            .castle-image-name,
            .monster-name,
            .mana-name,
            .research-name,
            .calendar-name,
            .castle-main-name {
                font-size: 20px;
                padding: 8px 0;
            }
            
            .welcome h1 { 
                font-size: 32px; 
            }
            .section-icon { 
                width: 100px; 
                height: 100px; 
                font-size: 52px; 
            }
        }

        /* –î–õ–Ø –°–í–ï–†–•–ú–ê–õ–ï–ù–¨–ö–ò–• –¢–ï–õ–ï–§–û–ù–û–í */
        @media (max-width: 380px) {
            .monster-image-container h2 {
                font-size: 22px;
            }
            
            .castle-image-name,
            .monster-name,
            .mana-name,
            .research-name,
            .calendar-name,
            .castle-main-name {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <span class="logo-icon">‚öîÔ∏è</span>
                <span class="logo-text">Lords Mobile Helper</span>
            </div>
            <div id="backButton" class="back-btn" onclick="goToMainMenu()" style="display: none;">
                ‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é
            </div>
            <div class="version" id="versionBadge">v1.0</div>
        </div>

        <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
        <div id="mainMenuScreen" class="screen active">
            <div class="welcome">
                <h1>üè∞ Lords Mobile Helper</h1>
                <p>–ü–æ–¥—Å–∫–∞–∑–∫–∏, –≥–∞–π–¥—ã, —Å–æ—Å—Ç–∞–≤—ã –≥–µ—Ä–æ–µ–≤ –Ω–∞ –º–æ–±–æ–≤</p>
            </div>
            <div class="sections-grid">
                <div class="section-card" onclick="openSection('magic-hunt')">
                    <div class="section-icon">üßô‚Äç‚ôÇÔ∏è</div>
                    <div class="section-title">–û—Ö–æ—Ç–∞ –º–∞–≥–∏</div>
                </div>
                <div class="section-card" onclick="openSection('agile-hunt')">
                    <div class="section-icon">üèπ</div>
                    <div class="section-title">–û—Ö–æ—Ç–∞ –ª–æ–≤–∫–∏–µ</div>
                </div>
                <div class="section-card" onclick="openSection('calendar')">
                    <div class="section-icon">üìÖ</div>
                    <div class="section-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
                </div>
                <div class="section-card" onclick="openSection('research')">
                    <div class="section-icon">üî¨</div>
                    <div class="section-title">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</div>
                </div>
                <div class="section-card" onclick="openSection('mana')">
                    <div class="section-icon">üíé</div>
                    <div class="section-title">–ú–∞–Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ</div>
                </div>
                <div class="section-card" onclick="openSection('castle-styles')">
                    <div class="section-icon">üè∞</div>
                    <div class="section-title">–°—Ç–∏–ª–∏ –∑–∞–º–∫–∞</div>
                </div>
                <div class="section-card" onclick="openSection('astralite')">
                    <div class="section-icon">‚ú®</div>
                    <div class="section-title">–ê—Å—Ç—Ä–∞–ª–∏—Ç</div>
                </div>
                <div class="section-card" onclick="openSection('calculators')">
                    <div class="section-icon">üßÆ</div>
                    <div class="section-title">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</div>
                </div>
            </div>
            
            <!-- –§–£–¢–ï–† –° –ò–°–¢–û–ß–ù–ò–ö–ê–ú–ò -->
            <div class="footer">
                <div class="footer-sources">
                    <div style="color: #ffd966; margin-bottom: 8px;">üì¢ #–∏—Å—Ç–æ—á–Ω–∏–∫–∏</div>
                    <div class="footer-links">
                        <a href="https://t.me/LmNewsEx" target="_blank" class="footer-link">t.me/LmNewsEx</a>
                        <a href="https://t.me/INF0_LM" target="_blank" class="footer-link">t.me/INF0_LM</a>
                        <a href="https://t.me/wikipedialm" target="_blank" class="footer-link">t.me/wikipedialm</a>
                        <a href="https://t.me/kostya_23rus" target="_blank" class="footer-link">@kostya_23rus</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û–•–û–¢–ê –ú–ê–ì–ò -->
        <div id="magicHuntScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üßô‚Äç‚ôÇÔ∏è –û—Ö–æ—Ç–∞ –º–∞–≥–∏</h1>
            </div>
            <div id="magicMonstersGrid" class="monsters-grid"></div>
            <div id="magicImageContainer" class="monster-image-container" style="display: none;"></div>
        </div>

        <!-- –û–•–û–¢–ê –õ–û–í–ö–ò–ï -->
        <div id="agileHuntScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üèπ –û—Ö–æ—Ç–∞ –ª–æ–≤–∫–∏–µ</h1>
            </div>
            <div id="agileMonstersGrid" class="monsters-grid"></div>
            <div id="agileImageContainer" class="monster-image-container" style="display: none;"></div>
        </div>

        <!-- –ö–ê–õ–ï–ù–î–ê–†–¨ -->
        <div id="calendarScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</h1>
            </div>
            <div id="calendarGrid" class="calendar-grid"></div>
            <div id="calendarImageContainer" class="monster-image-container" style="display: none;"></div>
        </div>

        <!-- –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø -->
        <div id="researchScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üî¨ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</h1>
            </div>
            <div id="researchGrid" class="research-grid"></div>
            <div id="researchImageContainer" class="monster-image-container" style="display: none;"></div>
        </div>

        <!-- –ú–ê–ù–ê –£–õ–£–ß–®–ï–ù–ò–ï -->
        <div id="manaScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üíé –ú–∞–Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ</h1>
            </div>
            <div id="manaGrid" class="mana-grid"></div>
            <div id="manaImageContainer" class="monster-image-container" style="display: none;"></div>
        </div>

        <!-- –°–¢–ò–õ–ò –ó–ê–ú–ö–ê -->
        <div id="castleStylesScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üè∞ –°—Ç–∏–ª–∏ –∑–∞–º–∫–∞</h1>
            </div>
            <div id="castleStylesContent"></div>
        </div>

        <!-- –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–´ -->
        <div id="calculatorsScreen" class="screen">
            <div class="section-title-hunt">
                <h1>üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</h1>
            </div>
            <div id="calculatorsGrid" class="castle-main-grid"></div>
            <div id="calculatorFrameContainer" style="display: none; width: 100%; height: 90vh; min-height: 600px; margin-top: 20px;"></div>
        </div>

    </div>

    <script>
        // =========================================================
        // –ú–ê–ì–ò ‚Äî 13 –ú–û–ù–°–¢–†–û–í
        // =========================================================
        const magicMonstersData = [
            { id: 'gargantua', name: '–ì–∞—Ä–≥–∞–Ω—Ç—é–∞', imagePath: 'https://i.yapx.ru/c534E.jpg' },
            { id: 'saber', name: '–°–∞–±–ª–µ–∑—É–±', imagePath: 'https://i.yapx.ru/c535F.jpg' },
            { id: 'jade', name: '–ù–µ—Ñ—Ä–∏—Ç–æ–≤—ã–π –∑–º–µ–π', imagePath: 'https://i.yapx.ru/c537c.jpg' },
            { id: 'titan', name: '–¢–∏—Ç–∞–Ω', imagePath: 'https://i.yapx.ru/c538j.jpg' },
            { id: 'ancient', name: '–î—Ä–µ–≤–Ω–∏–π –≥–æ–ª–µ–º', imagePath: 'https://i.yapx.ru/c538v.jpg' },
            { id: 'maggot', name: '–ú–∞–≥–æ—Ç', imagePath: 'https://i.yapx.ru/c539B.jpg' },
            { id: 'trojan', name: '–¢—Ä–æ—è–Ω—Å–∫–∏–π –∫–æ–Ω—å', imagePath: 'https://i.yapx.ru/c539Q.jpg' },
            { id: 'rhino', name: '–†–∏–Ω–æ', imagePath: 'https://i.yapx.ru/c54Gw.png' },
            { id: 'nag', name: '–ù–∞–≥-–≥–ª–∞–¥–∏–∞—Ç–æ—Ä', imagePath: 'https://i.yapx.ru/c54E7.jpg' },
            { id: 'necrosis', name: '–ù–µ–∫—Ä–æ–∑–∏—Å', imagePath: 'https://i.yapx.ru/c54Kr.png' },
            { id: 'oswald', name: '–û—Å–≤–∞–ª—å–¥', imagePath: 'https://i.yapx.ru/c54HB.png' },
            { id: 'paw', name: '–ñ—É—Ç–∫–∞—è –ª–∞–ø–∞', imagePath: 'https://i.yapx.ru/c54HT.png' },
            { id: 'uk', name: '–ë–æ–ª—å—à–æ–π –£–∫', imagePath: 'https://i.yapx.ru/c54Jc.jpg' }
        ];

        // =========================================================
        // –õ–û–í–ö–ò–ï ‚Äî 11 –ú–û–ù–°–¢–†–û–í
        // =========================================================
        const agileMonstersData = [
            { id: 'griffon', name: '–ì—Ä–∏—Ñ–æ–Ω', imagePath: 'https://i.yapx.ru/c54u7.png' },
            { id: 'ledokryl', name: '–õ–µ–¥–æ–∫—Ä—ã–ª', imagePath: 'https://i.yapx.ru/c54qF.png' },
            { id: 'thorn', name: '–®–∏–ø —É–∂–∞—Å–∞', imagePath: 'https://i.yapx.ru/c54yT.png' },
            { id: 'hellspider', name: '–ê–¥—Å–∫–∏–π –¥—Ä–∞–π–¥–µ—Ä', imagePath: 'https://i.yapx.ru/c540e.png' },
            { id: 'shaman', name: '–®–∞–º–∞–Ω –í—É–¥—É', imagePath: 'https://i.yapx.ru/c541d.png' },
            { id: 'reaper', name: '–ú—Ä–∞—á–Ω—ã–π –∂–Ω–µ—Ü', imagePath: 'https://i.yapx.ru/c542Z.png' },
            { id: 'vivian', name: '–¢–æ—â–∞—è –í–∏–≤–∏–∞–Ω', imagePath: 'https://i.yapx.ru/c545L.png' },
            { id: 'beequeen', name: '–ö–æ—Ä–æ–ª–µ–≤–∞ –ø—á–µ–ª', imagePath: 'https://i.yapx.ru/c544g.png' },
            { id: 'blackwing', name: '–ß–µ—Ä–Ω–æ–∫—Ä—ã–ª', imagePath: 'https://i.yapx.ru/c55BJ.png' },
            { id: 'crazyhouse', name: '–ë–µ—à–µ–Ω—ã–π —Ç–µ—Ä–µ–º–æ–∫', imagePath: 'https://i.yapx.ru/c55C0.png' },
            { id: 'vyuzhnik', name: '–í—å—é–∂–Ω–∏–∫', imagePath: 'https://i.yapx.ru/c55CN.png' }
        ];

        // =========================================================
        // –ö–ê–õ–ï–ù–î–ê–†–¨ ‚Äî 4 –°–û–ë–´–¢–ò–Ø
        // =========================================================
        const calendarData = [
            { id: 'labyrinth', name: '–õ–∞–±–∏—Ä–∏–Ω—Ç', imagePath: 'https://i.yapx.ru/c57R3.png' },
            { id: 'treasury', name: '–°–æ–∫—Ä–æ–≤–∏—â–Ω–∏—Ü–∞', imagePath: 'https://i.yapx.ru/c57Dz.png' },
            { id: 'arena', name: '–ê—Ä–µ–Ω–∞ —Ö–∞–æ—Å–∞ + –≠–∫—Å–ø–∞ + –ü–ì', imagePath: 'https://i.yapx.ru/c57GS.png' },
            { id: 'hell', name: '–ê–¥ + –ö–í–ö + –ü–∞–ª–∞–¥–∏–Ω–∫–∞ + –ë–∞—Ä–æ–Ω–∫–∞ + –ò–º–ø–∞', imagePath: 'https://i.yapx.ru/c57Hg.png' }
        ];

        // =========================================================
        // –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø ‚Äî 6 –ö–ê–†–¢–û–ß–ï–ö
        // =========================================================
        const researchData = [
            { id: 'countertypes', name: '–ö–æ–Ω—Ç—Ä—Ç–∏–ø—ã', imagePath: 'https://i.yapx.ru/c57dk.png' },
            { id: 'familiar', name: '–ë–∏—Ç–≤–∞ —Ñ–∞–º–∏–ª—å—è—Ä–æ–≤', imagePath: 'https://i.yapx.ru/c57eP.png' },
            { id: 'sigils', name: '–°–∏–≥–∏–ª—ã', imagePath: 'https://i.yapx.ru/c57fE.png' },
            { id: 'ammunition', name: '–ê–º—É–Ω–∏—Ü–∏—è', imagePath: 'https://i.yapx.ru/c57fX.png' },
            { id: 'wonder', name: '–ë–∏—Ç–≤–∞ –∑–∞ —á—É–¥–µ—Å–∞', imagePath: 'https://i.yapx.ru/c57gi.png' },
            { id: 'wonderupgrade', name: '–£–ª—É—á—à–µ–Ω–∏–µ –±–∏—Ç–≤ –∑–∞ —á—É–¥–µ—Å–∞', imagePath: 'https://i.yapx.ru/c57iE.png' }
        ];

        // =========================================================
        // –ú–ê–ù–ê –£–õ–£–ß–®–ï–ù–ò–ï ‚Äî 6 –ö–ê–†–¢–û–ß–ï–ö
        // =========================================================
        const manaData = [
            { id: 'mana1', name: '–ú–∞–Ω–∞ +1', imagePath: 'https://i.yapx.ru/c570G.png' },
            { id: 'mana2', name: '–ú–∞–Ω–∞ +2', imagePath: 'https://i.yapx.ru/c570f.png' },
            { id: 'mana3', name: '–ú–∞–Ω–∞ +3', imagePath: 'https://i.yapx.ru/c571H.png' },
            { id: 'mana4', name: '–ú–∞–Ω–∞ +4', imagePath: 'https://i.yapx.ru/c571Q.png' },
            { id: 'mana5', name: '–ú–∞–Ω–∞ +5', imagePath: 'https://i.yapx.ru/c571w.png' },
            { 
                id: 'mana6', 
                name: '–ú–∞–Ω–∞ +6', 
                imagePath: 'https://i.yapx.ru/c572H.png',
                steelImagePath: 'https://i.yapx.ru/c572c.png'
            }
        ];

        // =========================================================
        // –°–¢–ò–õ–ò –ó–ê–ú–ö–ê ‚Äî 4 –û–°–ù–û–í–ù–´–• –†–ê–ó–î–ï–õ–ê
        // =========================================================
        const castleStylesData = [
            { 
                id: 'atk_oz', 
                name: '–ê—Ç–∫+–û–∑',
                subcategories: [
                    { 
                        id: 'atk_oz_cav', 
                        name: '–ê—Ç–∫+–û–∑ –∫–∞–≤–∞–ª–µ—Ä–∏—è',
                        images: [
                            { id: 'arcade', name: '–ê—Ä–∫–∞–¥–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ', imagePath: 'https://i.yapx.ru/c58SW.png' },
                            { id: 'starry_tree', name: '–ó–≤—ë–∑–¥–Ω–æ–µ –¥–µ—Ä–µ–≤–æ', imagePath: 'https://i.yapx.ru/c58S2.png' },
                            { id: 'starry_express', name: '–ó–≤—ë–∑–¥–Ω—ã–π —ç–∫—Å–ø—Ä–µ—Å—Å', imagePath: 'https://i.yapx.ru/c58To.png' },
                            { id: 'frosty_flight', name: '–ú–æ—Ä–æ–∑–Ω—ã–π –ø–æ–ª—ë—Ç', imagePath: 'https://i.yapx.ru/c58UK.png' },
                            { id: 'panda_haven', name: '–û–±–∏—Ç–µ–ª—å –ø–∞–Ω–¥—ã', imagePath: 'https://i.yapx.ru/c58Un.png' },
                            { id: 'onsen', name: '–û–Ω—Å—ç–Ω —Å –∫–∞–ø–∏–±–∞—Ä–∞–º–∏', imagePath: 'https://i.yapx.ru/c58Va.png' },
                            { id: 'bottle', name: '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –±—É—Ç—ã–ª–∫–µ', imagePath: 'https://i.yapx.ru/c58WE.png' },
                            { id: 'sacred_temple', name: '–°–≤—è—â–µ–Ω–Ω—ã–π —Ö—Ä–∞–º', imagePath: 'https://i.yapx.ru/c58Wy.png' },
                            { id: 'northern_lights', name: '–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ', imagePath: 'https://i.yapx.ru/c58Xr.png' },
                            { id: 'dragon_maw', name: '–ü–∞—Å—Ç—å –¥—Ä–∞–∫–æ–Ω–∞', imagePath: 'https://i.yapx.ru/c58ZP.png' },
                            { id: 'bloody_scales', name: '–¶–∏—Ç–∞–¥–µ–ª—å –∫—Ä–æ–≤–∞–≤–æ–π —á–µ—à—É–∏', imagePath: 'https://i.yapx.ru/c58YN.png', fullWidth: true }
                        ]
                    },
                    { 
                        id: 'atk_oz_range', 
                        name: '–ê—Ç–∫+–û–∑ —Å—Ç—Ä–µ–ª–∫–∏',
                        images: [
                            { id: 'flower_courtyard', name: '–¶–≤–µ—Ç–æ—á–Ω—ã–π –¥–≤–æ—Ä–∏–∫', imagePath: 'https://i.yapx.ru/c6AvH.png' },
                            { id: 'gloomy_mansion', name: '–ú—Ä–∞—á–Ω—ã–π –æ—Å–æ–±–Ω—è–∫', imagePath: 'https://i.yapx.ru/c6Awu.png' },
                            { id: 'underwater_adventure', name: '–ü–æ–¥–≤–æ–¥–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ', imagePath: 'https://i.yapx.ru/c6Ayr.png' },
                            { id: 'quiet_grove', name: '–¢–∏—Ö–∞—è —Ä–æ—â–∞', imagePath: 'https://i.yapx.ru/c6A1v.png' },
                            { id: 'neon_city', name: '–ù–µ–æ–Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥', imagePath: 'https://i.yapx.ru/c6A2k.png' },
                            { id: 'quiet_water', name: '–ß–∞–π–Ω–∞—è "–¢–∏—Ö–∞—è –≤–æ–¥–∞"', imagePath: 'https://i.yapx.ru/c6A3I.png' },
                            { id: 'eternal_flame', name: '–ù–µ—É–≥–∞—Å–∞–µ–º–æ–µ –ø–ª–∞–º—è', imagePath: 'https://i.yapx.ru/c6A3v.png' },
                            { id: 'golden_dragon', name: '–ó–ª–∞—Ç–æ–∫–∞–º–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω', imagePath: 'https://i.yapx.ru/c6A4r.png' },
                            { id: 'azure_melody', name: '–õ–∞–∑—É—Ä–Ω–∞—è –º–µ–ª–æ–¥–∏—è', imagePath: 'https://i.yapx.ru/c6A5d.png' },
                            { id: 'cloud_abode', name: '–û–±–ª–∞—á–Ω–∞—è –æ–±–∏—Ç–µ–ª—å', imagePath: 'https://i.yapx.ru/c6A6V.png' },
                            { id: 'frosty_fun', name: '–ú–æ—Ä–æ–∑–Ω–æ–µ –≤–µ—Å–µ–ª—å–µ', imagePath: 'https://i.yapx.ru/c6A7I.png', fullWidth: true }
                        ]
                    },
                    { 
                        id: 'atk_oz_inf', 
                        name: '–ê—Ç–∫+–û–∑ –ø–µ—Ö–æ—Ç–∞',
                        images: [
                            { id: 'dreamy_dragon', name: '–ú–µ—á—Ç–∞—Ç–µ–ª—å–Ω—ã–π –¥—Ä–∞–∫–æ–Ω—á–∏–∫', imagePath: 'https://i.yapx.ru/c6Bcy.png' },
                            { id: 'harvest_feast', name: '–£—Ä–æ–∂–∞–π–Ω—ã–π –ø–∏—Ä', imagePath: 'https://i.yapx.ru/c6BdY.png' },
                            { id: 'starry_whale', name: '–ó–≤–µ–∑–¥–Ω—ã–π –∫–∏—Ç', imagePath: 'https://i.yapx.ru/c6Bd2.png' },
                            { id: 'lords_legacy', name: '–ù–∞—Å–ª–µ–¥–∏–µ –ª–æ—Ä–¥–æ–≤', imagePath: 'https://i.yapx.ru/c6BeX.png' },
                            { id: 'samurai_house', name: '–î–æ–º —Å–∞–º—É—Ä–∞—è', imagePath: 'https://i.yapx.ru/c6Be3.png' },
                            { id: 'justice_labyrinth', name: '–õ–∞–±–∏—Ä–∏–Ω—Ç –ø—Ä–∞–≤–æ—Å—É–¥–∏—è', imagePath: 'https://i.yapx.ru/c6BfT.png' },
                            { id: 'radiant_tree', name: '–õ—É—á–µ–∑–∞—Ä–Ω–æ–µ –¥—Ä–µ–≤–æ', imagePath: 'https://i.yapx.ru/c6Bfi.png' },
                            { id: 'fortune_palace', name: '–î–≤–æ—Ä–µ—Ü –§–æ—Ä—Ç—É–Ω—ã', imagePath: 'https://i.yapx.ru/c6Bf9.png' },
                            { id: 'azure_guardian', name: '–õ–∞–∑—É—Ä–Ω—ã–π —Å—Ç—Ä–∞–∂', imagePath: 'https://i.yapx.ru/c6Bgd.png' },
                            { id: 'mysterious_manor', name: '–ó–∞–≥–∞–¥–æ—á–Ω–∞—è —É—Å–∞–¥—å–±–∞', imagePath: 'https://i.yapx.ru/c6Bg4.png' }
                        ]
                    }
                ]
            },
            { 
                id: 'atk_two_types', 
                name: '–ê—Ç–∫ –¥–≤—É—Ö —Ç–∏–ø–æ–≤',
                images: [
                    { id: 'horror_lodge', name: '–°—Ç–æ—Ä–æ–∂–∫–∞ —É–∂–∞—Å–∞', imagePath: 'https://i.yapx.ru/c6EZ3.png' },
                    { id: 'golden_scales_citadel', name: '–¶–∏—Ç–∞–¥–µ–ª—å –∑–æ–ª–æ—Ç–æ–π —á–µ—à—É–∏', imagePath: 'https://i.yapx.ru/c6Eaz.png' },
                    { id: 'winter_wonder', name: '–ó–∏–º–Ω–µ–µ —á—É–¥–æ', imagePath: 'https://i.yapx.ru/c6EdB.png' },
                    { id: 'treasure_galleon', name: '–ì–∞–ª–µ–æ–Ω —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏', imagePath: 'https://i.yapx.ru/c6Edg.png' },
                    { id: 'owl_haven', name: '–°–æ–≤–∏–Ω–∞—è –æ–±–∏—Ç–µ–ª—å', imagePath: 'https://i.yapx.ru/c6EeZ.png' },
                    { id: 'forbidden_palace', name: '–ó–∞–ø—Ä–µ—Ç–Ω—ã–π –¥–≤–æ—Ä–µ—Ü', imagePath: 'https://i.yapx.ru/c6EfC.png' },
                    { id: 'pearl_coast', name: '–ñ–µ–º—á—É–∂–Ω—ã–π –±–µ—Ä–µ–≥', imagePath: 'https://i.yapx.ru/c6Efd.png' },
                    { id: 'fire_fortress', name: '–û–≥–Ω–µ–Ω–Ω–∞—è –∫—Ä–µ–ø–æ—Å—Ç—å', imagePath: 'https://i.yapx.ru/c6EgA.png' },
                    { id: 'heavenly_court', name: '–ù–µ–±–µ—Å–Ω—ã–π –¥–≤–æ—Ä', imagePath: 'https://i.yapx.ru/c6EiH.png', fullWidth: true }
                ]
            },
            { 
                id: 'styles_oz', 
                name: '–°—Ç–∏–ª–∏ –Ω–∞ –û–∑',
                images: [
                    { id: 'ancient_pyramid', name: '–î—Ä–µ–≤–Ω—è—è –ø–∏—Ä–∞–º–∏–¥–∞', imagePath: 'https://i.yapx.ru/c6GGg.png' },
                    { id: 'wyvern_haven', name: '–û–±–∏—Ç–µ–ª—å –í–∏–≤–µ—Ä–Ω—ã', imagePath: 'https://i.yapx.ru/c6GHP.png' },
                    { id: 'playground', name: '–î–µ—Ç—Å–∫–∞—è –ø–ª–æ—â–∞–¥–∫–∞', imagePath: 'https://i.yapx.ru/c6GIU.png' },
                    { id: 'steam_hut', name: '–ü–∞—Ä–æ–≤–∞—è —Ö–∏–∂–∏–Ω–∞', imagePath: 'https://i.yapx.ru/c6GI4.png' },
                    { id: 'desert_oasis', name: '–ü—É—Å—Ç—ã–Ω–Ω—ã–π –æ–∞–∑–∏—Å', imagePath: 'https://i.yapx.ru/c6GJu.png' },
                    { id: 'gingerbread_castle', name: '–ü—Ä—è–Ω–∏—á–Ω—ã–π –∑–∞–º–æ–∫', imagePath: 'https://i.yapx.ru/c6GKK.png' },
                    { id: 'magic_mushroom', name: '–í–æ–ª—à–µ–±–Ω—ã–π –º—É—Ö–æ–º–æ—Ä', imagePath: 'https://i.yapx.ru/c6GKj.png' },
                    { id: 'unicorn_abyss', name: '–ë–µ–∑–¥–Ω–∞ –ï–¥–∏–Ω–æ—Ä–æ–≥–∞', imagePath: 'https://i.yapx.ru/c6GK3.png' },
                    { id: 'fairytale_palace', name: '–°–∫–∞–∑–æ—á–Ω—ã–π –¥–≤–æ—Ä–µ—Ü', imagePath: 'https://i.yapx.ru/c6GLR.png', fullWidth: true }
                ]
            },
            { 
                id: 'other', 
                name: '–ü—Ä–æ—á–µ–µ',
                images: [
                    { id: 'lion_stronghold', name: '–¢–≤–µ—Ä–¥—ã–Ω—è –ª—å–≤–∞', imagePath: 'https://i.yapx.ru/c6H1Y.png' },
                    { id: 'arctic_base', name: '–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞', imagePath: 'https://i.yapx.ru/c6H2N.png' },
                    { id: 'cirque', name: '–¶–∏—Ä–∫ –î—é –°–æ–ª–µ–π', imagePath: 'https://i.yapx.ru/c6H3O.png' },
                    { id: 'dragon_peak', name: '–î—Ä–∞–∫–æ–Ω–∏–π –ø–∏–∫', imagePath: 'https://i.yapx.ru/c6H4I.png' },
                    { id: 'dark_citadel', name: '–¶–∏—Ç–∞–¥–µ–ª—å –ú—Ä–∞–∫–∞', imagePath: 'https://i.yapx.ru/c6H5T.png' },
                    { id: 'sun_citadel', name: '–¶–∏—Ç–∞–¥–µ–ª—å —Å–æ–ª–Ω—Ü–∞', imagePath: 'https://i.yapx.ru/c6H6N.png' },
                    { id: 'paradise_island', name: '–†–∞–π—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤', imagePath: 'https://i.yapx.ru/c6H7j.png' },
                    { id: 'mysterious_manor2', name: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–º–µ—Å—Ç—å–µ', imagePath: 'https://i.yapx.ru/c6H82.png' },
                    { id: 'classic_castle', name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∑–∞–º–æ–∫', imagePath: 'https://i.yapx.ru/c6IAE.png', fullWidth: true }
                ]
            }
        ];

        // =========================================================
        // –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–´ ‚Äî 3 –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê, –°–ï–¢–ö–ê 1 –°–¢–û–õ–ë–ò–ö
        // =========================================================
        const calculatorsData = [
            { 
                id: 'mana', 
                name: 'üßÆ –ú–∞–Ω–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä', 
                url: 'https://4uter0k.github.io/mana-calculator/',
                description: '–†–∞—Å—á—ë—Ç –º–∞–Ω—ã –¥–ª—è –ø—Ä–æ–∫–∞—á–∫–∏ –∑–∞–º–∫–∞'
            },
            { 
                id: 'foliant', 
                name: 'üìö –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ñ–æ–ª–∏–∞–Ω—Ç–æ–≤', 
                url: 'https://4uter0k.github.io/calculator-foliant/',
                description: '–†–∞—Å—á—ë—Ç —Ñ–æ–ª–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π'
            },
            { 
                id: 'acceleration', 
                name: '‚ö° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–æ–≤', 
                url: 'https://4uter0k.github.io/acceleration-calculator/',
                description: '–†–∞—Å—á—ë—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–π, –æ–ø—ã—Ç–∞ –∏ —ç–Ω–µ—Ä–≥–∏–∏'
            }
        ];

        let currentItemId = null;
        let currentSection = null;
        let currentMainCategory = null;
        let currentSubCategory = null;
        let previousLevel = null;

        function openSection(sectionId) {
            document.getElementById('mainMenuScreen').classList.remove('active');
            document.getElementById('magicHuntScreen').classList.remove('active');
            document.getElementById('agileHuntScreen').classList.remove('active');
            document.getElementById('calendarScreen').classList.remove('active');
            document.getElementById('researchScreen').classList.remove('active');
            document.getElementById('manaScreen').classList.remove('active');
            document.getElementById('castleStylesScreen').classList.remove('active');
            document.getElementById('calculatorsScreen').classList.remove('active');
            
            if (sectionId === 'magic-hunt') {
                document.getElementById('magicHuntScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'magic';
                renderMonsterGrid('magic');
            } 
            else if (sectionId === 'agile-hunt') {
                document.getElementById('agileHuntScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'agile';
                renderMonsterGrid('agile');
            }
            else if (sectionId === 'calendar') {
                document.getElementById('calendarScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'calendar';
                renderCalendarGrid();
            }
            else if (sectionId === 'research') {
                document.getElementById('researchScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'research';
                renderResearchGrid();
            }
            else if (sectionId === 'mana') {
                document.getElementById('manaScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'mana';
                renderManaGrid();
            }
            else if (sectionId === 'castle-styles') {
                document.getElementById('castleStylesScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'castle-styles';
                renderCastleStylesMain();
            }
            else if (sectionId === 'calculators') {
                document.getElementById('calculatorsScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'block';
                document.getElementById('versionBadge').style.display = 'none';
                currentSection = 'calculators';
                renderCalculatorsGrid();
            }
            else {
                document.getElementById('mainMenuScreen').classList.add('active');
                document.getElementById('backButton').style.display = 'none';
                document.getElementById('versionBadge').style.display = 'block';
                alert('–†–∞–∑–¥–µ–ª "' + sectionId + '" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
            }
        }

        function goToMainMenu() {
            document.getElementById('mainMenuScreen').classList.add('active');
            document.getElementById('magicHuntScreen').classList.remove('active');
            document.getElementById('agileHuntScreen').classList.remove('active');
            document.getElementById('calendarScreen').classList.remove('active');
            document.getElementById('researchScreen').classList.remove('active');
            document.getElementById('manaScreen').classList.remove('active');
            document.getElementById('castleStylesScreen').classList.remove('active');
            document.getElementById('calculatorsScreen').classList.remove('active');
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('versionBadge').style.display = 'block';
        }

        // =========================================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–û–í
        // =========================================================
        function renderCalculatorsGrid() {
            const container = document.getElementById('calculatorsGrid');
            container.innerHTML = '';
            container.style.display = 'flex';
            
            calculatorsData.forEach(calc => {
                const card = document.createElement('div');
                card.className = 'castle-main-card';
                card.dataset.calcId = calc.id;
                card.onclick = () => showCalculator(calc.id);
                card.innerHTML = `
                    <div class="castle-main-name">${calc.name}</div>
                    <div style="color: #a2aec4; font-size: 16px; margin-top: 5px;">${calc.description}</div>
                `;
                container.appendChild(card);
            });
        }

        function showCalculator(calcId) {
            const calc = calculatorsData.find(c => c.id === calcId);
            if (!calc) return;
            
            document.getElementById('calculatorsGrid').style.display = 'none';
            
            const frameContainer = document.getElementById('calculatorFrameContainer');
            frameContainer.style.display = 'block';
            frameContainer.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <h2 style="cursor: pointer; color: #ffd966; font-size: 28px; margin: 0;" onclick="backToCalculators()">‚Üê –ù–∞–∑–∞–¥</h2>
                    <span style="color: #ffd966; font-size: 28px; margin-left: 20px;">${calc.name}</span>
                </div>
                <iframe 
                    src="${calc.url}" 
                    style="width: 100%; height: calc(90vh - 60px); min-height: 600px; border: none; border-radius: 16px; background: #0f141f; border: 2px solid #3f4a5e;"
                    title="${calc.name}"
                    loading="lazy">
                </iframe>
            `;
        }

        function backToCalculators() {
            document.getElementById('calculatorsGrid').style.display = 'flex';
            document.getElementById('calculatorFrameContainer').style.display = 'none';
        }

        // =========================================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–¢–ò–õ–ï–ô –ó–ê–ú–ö–ê
        // =========================================================
        function renderCastleStylesMain() {
            const content = document.getElementById('castleStylesContent');
            content.innerHTML = '';
            
            currentMainCategory = null;
            currentSubCategory = null;
            previousLevel = 'main';
            
            const grid = document.createElement('div');
            grid.className = 'castle-main-grid';
            
            castleStylesData.forEach(category => {
                const card = document.createElement('div');
                card.className = 'castle-main-card';
                card.dataset.categoryId = category.id;
                card.onclick = () => showCastleSubcategories(category.id);
                card.innerHTML = `<div class="castle-main-name">${category.name}</div>`;
                grid.appendChild(card);
            });
            
            content.appendChild(grid);
        }

        function showCastleSubcategories(categoryId) {
            const category = castleStylesData.find(c => c.id === categoryId);
            if (!category) return;
            
            currentMainCategory = categoryId;
            currentSubCategory = null;
            previousLevel = 'main';
            
            const content = document.getElementById('castleStylesContent');
            content.innerHTML = '';
            
            // –û—Å–æ–±—ã–π —Å–ª—É—á–∞–π –¥–ª—è –ê—Ç–∫ –¥–≤—É—Ö —Ç–∏–ø–æ–≤, –°—Ç–∏–ª–µ–π –Ω–∞ –û–∑ –∏ –ü—Ä–æ—á–µ–µ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å—Ä–∞–∑—É
            if (categoryId === 'atk_two_types' || categoryId === 'styles_oz' || categoryId === 'other') {
                showCastleImages(categoryId, null);
                return;
            }
            
            // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª—ã
            const grid = document.createElement('div');
            grid.className = 'castle-main-grid';
            
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
            const backCard = document.createElement('div');
            backCard.className = 'castle-main-card';
            backCard.onclick = () => renderCastleStylesMain();
            backCard.innerHTML = `<div class="castle-main-name" style="color: #ffd966;">‚Üê –ù–∞–∑–∞–¥ –∫ —Ä–∞–∑–¥–µ–ª–∞–º</div>`;
            grid.appendChild(backCard);
            
            // –ü–æ–¥—Ä–∞–∑–¥–µ–ª—ã
            if (category.subcategories && category.subcategories.length > 0) {
                category.subcategories.forEach(sub => {
                    const card = document.createElement('div');
                    card.className = 'castle-main-card';
                    card.dataset.subId = sub.id;
                    card.onclick = () => showCastleImages(categoryId, sub.id);
                    card.innerHTML = `<div class="castle-main-name">${sub.name}</div>`;
                    grid.appendChild(card);
                });
            } else {
                const emptyCard = document.createElement('div');
                emptyCard.className = 'castle-main-card';
                emptyCard.innerHTML = '<div class="castle-main-name" style="color: #a2aec4;">–ù–µ—Ç –ø–æ–¥—Ä–∞–∑–¥–µ–ª–æ–≤</div>';
                grid.appendChild(emptyCard);
            }
            
            content.appendChild(grid);
        }

        function showCastleImages(categoryId, subId) {
            const category = castleStylesData.find(c => c.id === categoryId);
            if (!category) return;
            
            let subcategory;
            let backTarget;
            
            // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –ø—Ä—è–º—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
            if (categoryId === 'atk_two_types' || categoryId === 'styles_oz' || categoryId === 'other') {
                subcategory = { images: category.images };
                backTarget = 'main';
            } else {
                subcategory = category.subcategories.find(s => s.id === subId);
                if (!subcategory) return;
                currentSubCategory = subId;
                backTarget = 'subcategories';
            }
            
            previousLevel = 'subcategories';
            
            const content = document.getElementById('castleStylesContent');
            content.innerHTML = '';
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π –Ω–∞–∑–∞–¥ ‚Äî –í–°–ï–ì–î–ê "‚Üê –ù–∞–∑–∞–¥"
            const header = document.createElement('h2');
            header.style.cursor = 'pointer';
            header.style.color = '#ffd966';
            header.style.marginBottom = '30px';
            header.style.fontSize = '28px';
            header.innerHTML = `‚Üê –ù–∞–∑–∞–¥`;
            
            // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
            if (backTarget === 'main') {
                header.onclick = () => renderCastleStylesMain();
            } else {
                header.onclick = () => showCastleSubcategories(categoryId);
            }
            
            content.appendChild(header);
            
            if (subcategory.images && subcategory.images.length > 0) {
                // –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ç–∫—É 2 –∫–æ–ª–æ–Ω–∫–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π fullWidth
                let grid = document.createElement('div');
                grid.className = 'castle-images-grid';
                
                subcategory.images.forEach(img => {
                    if (img.fullWidth) {
                        // –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–∑–∞–∫–æ–Ω—á–µ–Ω–Ω–∞—è —Å–µ—Ç–∫–∞, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë
                        if (grid.children.length > 0) {
                            content.appendChild(grid);
                        }
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω–æ—à–∏—Ä–∏–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É
                        const fullCard = document.createElement('div');
                        fullCard.className = 'castle-image-card-full';
                        fullCard.onclick = () => showCastleSingleImage(img.imagePath, img.name);
                        fullCard.innerHTML = `<div class="castle-image-name">${img.name}</div>`;
                        content.appendChild(fullCard);
                        
                        // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é —Å–µ—Ç–∫—É
                        grid = document.createElement('div');
                        grid.className = 'castle-images-grid';
                    } else {
                        const card = document.createElement('div');
                        card.className = 'castle-image-card';
                        card.onclick = () => showCastleSingleImage(img.imagePath, img.name);
                        card.innerHTML = `<div class="castle-image-name">${img.name}</div>`;
                        grid.appendChild(card);
                    }
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–µ—Ç–∫—É
                if (grid.children.length > 0) {
                    content.appendChild(grid);
                }
                
                // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
                const imageContainer = document.createElement('div');
                imageContainer.id = 'castleSingleImageContainer';
                imageContainer.className = 'monster-image-container';
                imageContainer.style.display = 'none';
                imageContainer.style.marginTop = '30px';
                content.appendChild(imageContainer);
            } else {
                const emptyDiv = document.createElement('div');
                emptyDiv.style.color = '#a2aec4';
                emptyDiv.style.textAlign = 'center';
                emptyDiv.style.padding = '40px';
                emptyDiv.textContent = '–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π';
                content.appendChild(emptyDiv);
            }
        }

        function showCastleSingleImage(imagePath, name) {
            const container = document.getElementById('castleSingleImageContainer');
            container.style.display = 'block';
            container.innerHTML = `
                <h2>${name}</h2>
                <img src="${imagePath}" 
                     alt="${name}" 
                     class="monster-image"
                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text></svg>';">
            `;
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // =========================================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –û–°–¢–ê–õ–¨–ù–´–• –†–ê–ó–î–ï–õ–û–í
        // =========================================================
        function renderMonsterGrid(type) {
            const gridId = type === 'magic' ? 'magicMonstersGrid' : 'agileMonstersGrid';
            const grid = document.getElementById(gridId);
            const data = type === 'magic' ? magicMonstersData : agileMonstersData;
            
            grid.innerHTML = '';

            if (type === 'magic') {
                data.slice(0, 11).forEach(monster => {
                    grid.appendChild(createMonsterCard(monster, type));
                });

                const paw = data.find(m => m.id === 'paw');
                if (paw) grid.appendChild(createMonsterCard(paw, type));

                const uk = data.find(m => m.id === 'uk');
                if (uk) {
                    const ukCard = createMonsterCard(uk, type);
                    ukCard.style.gridColumn = '1 / -1';
                    grid.appendChild(ukCard);
                }
            } else {
                for (let i = 0; i < 9; i++) {
                    grid.appendChild(createMonsterCard(data[i], type));
                }

                const lastRow = document.createElement('div');
                lastRow.style.display = 'grid';
                lastRow.style.gridColumn = '1 / -1';
                lastRow.style.gridTemplateColumns = '1fr 1fr';
                lastRow.style.gap = '20px';

                const crazyhouse = createMonsterCard(data[9], type);
                const vyuzhnik = createMonsterCard(data[10], type);
                
                lastRow.appendChild(crazyhouse);
                lastRow.appendChild(vyuzhnik);
                grid.appendChild(lastRow);
            }
        }

        function renderCalendarGrid() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            calendarData.forEach(item => {
                const card = createCalendarCard(item);
                grid.appendChild(card);
            });
        }

        function renderResearchGrid() {
            const grid = document.getElementById('researchGrid');
            grid.innerHTML = '';
            researchData.forEach(item => {
                const card = createResearchCard(item);
                grid.appendChild(card);
            });
        }

        function renderManaGrid() {
            const grid = document.getElementById('manaGrid');
            grid.innerHTML = '';
            manaData.forEach(item => {
                const card = createManaCard(item);
                grid.appendChild(card);
            });
        }

        function createManaCard(item) {
            const card = document.createElement('div');
            card.className = `mana-card ${currentItemId === item.id && currentSection === 'mana' ? 'active' : ''}`;
            card.dataset.itemId = item.id;
            card.dataset.section = 'mana';
            card.onclick = () => showManaImage(item.id);
            card.innerHTML = `<div class="mana-name">${item.name}</div>`;
            return card;
        }

        function createResearchCard(item) {
            const card = document.createElement('div');
            card.className = `research-card ${currentItemId === item.id && currentSection === 'research' ? 'active' : ''}`;
            card.dataset.itemId = item.id;
            card.dataset.section = 'research';
            card.onclick = () => showResearchImage(item.id);
            card.innerHTML = `<div class="research-name">${item.name}</div>`;
            return card;
        }

        function createCalendarCard(item) {
            const card = document.createElement('div');
            card.className = `calendar-card ${currentItemId === item.id && currentSection === 'calendar' ? 'active' : ''}`;
            card.dataset.itemId = item.id;
            card.dataset.section = 'calendar';
            card.onclick = () => showCalendarImage(item.id);
            card.innerHTML = `<div class="calendar-name">${item.name}</div>`;
            return card;
        }

        function createMonsterCard(monster, type) {
            const card = document.createElement('div');
            card.className = `monster-card ${currentItemId === monster.id && currentSection === type ? 'active' : ''}`;
            card.dataset.itemId = monster.id;
            card.dataset.section = type;
            card.onclick = () => showMonsterImage(monster.id, type);
            card.innerHTML = `<div class="monster-name">${monster.name}</div>`;
            return card;
        }

        function showMonsterImage(itemId, type) {
            const data = type === 'magic' ? magicMonstersData : agileMonstersData;
            const item = data.find(i => i.id === itemId);
            if (!item) return;

            currentItemId = item.id;
            currentSection = type;
            
            const containerId = type === 'magic' ? 'magicMonstersGrid' : 'agileMonstersGrid';
            document.querySelectorAll(`#${containerId} .monster-card`).forEach(card => {
                card.classList.remove('active');
                if (card.dataset.itemId === itemId) {
                    card.classList.add('active');
                }
            });

            const imageContainerId = type === 'magic' ? 'magicImageContainer' : 'agileImageContainer';
            const container = document.getElementById(imageContainerId);
            container.style.display = 'block';
            
            container.innerHTML = `
                <h2>${item.name}</h2>
                <img src="${item.imagePath}" 
                     alt="${item.name}" 
                     class="monster-image"
                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>${item.name}</text></svg>';">
            `;
            container.scrollIntoView({ behavior: 'smooth' });
        }

        function showCalendarImage(itemId) {
            const item = calendarData.find(i => i.id === itemId);
            if (!item) return;

            currentItemId = item.id;
            currentSection = 'calendar';
            
            document.querySelectorAll('#calendarGrid .calendar-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.itemId === itemId) {
                    card.classList.add('active');
                }
            });

            const container = document.getElementById('calendarImageContainer');
            container.style.display = 'block';
            
            container.innerHTML = `
                <h2>${item.name}</h2>
                <img src="${item.imagePath}" 
                     alt="${item.name}" 
                     class="monster-image"
                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>${item.name}</text></svg>';">
            `;
            container.scrollIntoView({ behavior: 'smooth' });
        }

        function showResearchImage(itemId) {
            const item = researchData.find(i => i.id === itemId);
            if (!item) return;

            currentItemId = item.id;
            currentSection = 'research';
            
            document.querySelectorAll('#researchGrid .research-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.itemId === itemId) {
                    card.classList.add('active');
                }
            });

            const container = document.getElementById('researchImageContainer');
            container.style.display = 'block';
            
            container.innerHTML = `
                <h2>${item.name}</h2>
                <img src="${item.imagePath}" 
                     alt="${item.name}" 
                     class="monster-image"
                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>${item.name}</text></svg>';">
            `;
            container.scrollIntoView({ behavior: 'smooth' });
        }

        function showManaImage(itemId) {
            const item = manaData.find(i => i.id === itemId);
            if (!item) return;

            currentItemId = item.id;
            currentSection = 'mana';
            
            document.querySelectorAll('#manaGrid .mana-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.itemId === itemId) {
                    card.classList.add('active');
                }
            });

            const container = document.getElementById('manaImageContainer');
            container.style.display = 'block';
            
            if (item.id === 'mana6' && item.steelImagePath) {
                container.innerHTML = `
                    <h2>${item.name}</h2>
                    <img src="${item.imagePath}" 
                         alt="–ú–∞–Ω–∞ +6" 
                         class="monster-image"
                         style="margin-bottom: 20px;"
                         onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>–ú–∞–Ω–∞ +6</text></svg>';">
                    <img src="${item.steelImagePath}" 
                         alt="–ú–∞–Ω–∞-—Å—Ç–∞–ª—å +6" 
                         class="monster-image"
                         onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>–ú–∞–Ω–∞-—Å—Ç–∞–ª—å +6</text></svg>';">
                `;
            } else {
                container.innerHTML = `
                    <h2>${item.name}</h2>
                    <img src="${item.imagePath}" 
                         alt="${item.name}" 
                         class="monster-image"
                         onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22450%22><rect width=%22800%22 height=%22450%22 fill=%22%231e2535%22/><text x=%2250%22 y=%22225%22 fill=%22%23b0bedb%22 font-size=%2224%22>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</text><text x=%2250%22 y=%22270%22 fill=%22%23b0bedb%22 font-size=%2218%22>${item.name}</text></svg>';">
                `;
            }
            
            container.scrollIntoView({ behavior: 'smooth' });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.section-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.05}s`;
            });
        });

        window.openSection = openSection;
        window.goToMainMenu = goToMainMenu;
        window.showMonsterImage = showMonsterImage;
        window.showCalendarImage = showCalendarImage;
        window.showResearchImage = showResearchImage;
        window.showManaImage = showManaImage;
        window.renderCastleStylesMain = renderCastleStylesMain;
        window.showCastleSubcategories = showCastleSubcategories;
        window.showCastleImages = showCastleImages;
        window.showCastleSingleImage = showCastleSingleImage;
        window.renderCalculatorsGrid = renderCalculatorsGrid;
        window.showCalculator = showCalculator;
        window.backToCalculators = backToCalculators;
    </script>
</body>
</html>

